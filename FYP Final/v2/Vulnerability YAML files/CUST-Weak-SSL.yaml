id: CUST-Weak-SSL
name: "Weak SSL Configurations"
description: "Weak SSL Configurations is a vulnerability where the site either uses weak cipher suites susceptible to BEAST or POODLE attacks, deprecated SSL protocols such as SSLv2 and SSLv3, the lack of perfect forward secrecy or small key exchange sizes that could lead to logjam attack."
severity: Low
affected_versions: []
solution: "It is recommended to use a stronger hash algorithm, such as SHA2 as well as a more secure mode of operation such as GCM. Additionally, the use of cipher suites with perfect forward secrecy is recommended. Weak SSL/TLS versions should be removed, TLSv1.2 and above should be used instead. Lastly, key exchange sizes should be 2048 bits and above."
references: []
additional_information_check: True
additional_information_parsing: | 
    additional_information = json.loads(additional_information)
    total_ssl = []
    for cipher in additional_information['weak_ssl']:
        name = cipher['name']
        issues = cipher['issues']
        total_ssl.append(name + "\n\x95 " +"\n\x95 ".join(issues))
    
    if additional_information['heartbleed']:
        total_ssl.append(f"Heartbleed Vulnerability: The site is vulnerable to heartbleed attack.")
    if additional_information['deprecated']:
        total_ssl.append(f"Deprecated SSL/TLS: The site supports deprecated SSL/TLS versions (TLSv1.1 and below).")
    if additional_information['logjam']:
        total_ssl.append(f"Logjam Vulnerability: The site supports key exchange sizes of 1024 bits or lower.")
    str_arr.append('\n\n'.join(total_ssl))
