id: CWE-918
name: "Server-Side Request Forgery"
description: "The web server receives a URL or similar request from an upstream component and retrieves the contents of this URL, but it does not sufficiently ensure that the request is being sent to the expected destination."
severity: Medium
affected_versions: []
solution: "It is recommended perform input validation by establishing a list of URLs that the endpoint is allowed to access."
references: ["https://portswigger.net/web-security/ssrf","https://owasp.org/www-community/attacks/Server_Side_Request_Forgery","https://www.imperva.com/learn/application-security/server-side-request-forgery-ssrf/"]
additional_information_check: True
additional_information_parsing: | 
    additional_information = json.loads(additional_information)
    for k,v in additional_information.items():
      if k == "internal" and len(v) > 0:
        str_arr.append("The following URL(s) were susceptible to internal SSRF attack: ")
      if k == "external" and len(v) > 0:
        str_arr.append("The following URL(s) were susceptible to external SSRF attack: ")
      if len(v) > 0:
        for url in v:
          str_arr.append(f"\x95 {url}")
      

