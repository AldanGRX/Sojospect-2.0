id: CWE-1275-1004-614
name: "Weak Cookie Configurations"
description: "The website uses the cookie for sensitive operations, but the cookie is not marked with the HttpOnly flag, Secure flag and the Samesite flag."
severity: Low
affected_versions: []
solution: "It is recommended to enable the HttpOnly and Secure flag for the APP_SESSION cookie. It is also recommended to have Samesite attribute set as Lax or Strict."
references: ["https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/06-Session_Management_Testing/02-Testing_for_Cookies_Attributes"]
additional_information_check: True
additional_information_parsing: |
          additional_information = json.loads(additional_information)
          attribute_true = []
          for k,v in additional_information.items():
            if k.lower() == "samesite" :
              if v.lower() == "none" :
                attribute_true.append("'"+k+"'")
            else :
              if v == True :
                attribute_true.append("'"+k+"'")
          str_arr.append(f"The cookie attribute{'s' if len(attribute_true) > 1 else ''} {', '.join(attribute_true)} {'were' if len(attribute_true) > 1 else 'was'} not configured securely.")